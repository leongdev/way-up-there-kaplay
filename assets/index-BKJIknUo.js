import{E as Ae}from"./kaplay-BG-b9CQV.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const _ of s)if(_.type==="childList")for(const u of _.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const _={};return s.integrity&&(_.integrity=s.integrity),s.referrerPolicy&&(_.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?_.credentials="include":s.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function i(s){if(s.ep)return;s.ep=!0;const _=n(s);fetch(s.href,_)}})();const t=Ae({background:[0,0,0],scale:4,width:480,height:280,crisp:!0,letterbox:!0});var r=(e=>(e.PLAYER="player",e.STAIR="stair",e.SHIP="ship",e.PROJECTILE_A="projectile_a",e.CONTROLLER="controller",e.MIX_MACHINE="mix_machine",e.PRINT_CRYSTAL_MACHINE="print_crystal_machine",e.PRINT_POWER_MACHINE="print_power_machine",e.PRINT_UI_SELECTION="print_ui_selection",e.FUEL_MACHINE="fuel_machine",e.FUEL_CELL_INDICATOR="fuel_cell_indicator",e.FUEL_CELL_A="fuel_cell_a",e.FUEL_CELL_B="fuel_cell_b",e.FUEL_CELL_C="fuel_cell_c",e.FUEL_CELL_D="fuel_cell_d",e.FUEL_CELL_E="fuel_cell_e",e.FUEL_LINE="fuel_line",e.GRASS_A="grass_a",e.GRASS_B="grass_b",e.GRASS_C="grass_c",e.GRASS_D="grass_d",e.GRASS_E="grass_e",e.GRASS_F="grass_f",e.GRASS_G="grass_g",e.GRASS_H="grass_h",e.GRASS_I="grass_i",e.GRASS_J="grass_j",e.GRASS_K="grass_k",e.GRASS_L="grass_l",e.GRASS_M="grass_m",e.GRASS_N="grass_n",e.GRASS_O="grass_o",e.GRASS_P="grass_p",e.GRASS_Q="grass_q",e.COLLIDER="collider",e.COLLIDER_GROUND="collider_ground",e.CRYSTAL="crystal",e.POWER="power",e.PROGRESS="progress",e.MIX_DISPLAY="mix_display",e.STARS="stars",e.ALERT="alert",e.ENEMY_A="enemy_a",e))(r||{}),l=(e=>(e.ON_MOVE_SHIP_LEFT="onMoveShipLeft",e.ON_MOVE_SHIP_RIGHT="onMoveShipRight",e.ON_MOVE_SHIP_LEFT_UP="onMoveShipLeftUp",e.ON_MOVE_SHIP_RIGHT_UP="onMoveShipRightUp",e.ON_DISABLE_CONTROL_SHIP="onDisableControlShip",e.ON_ENABLE_CONTROL_SHIP="onEnableControlShip",e.ON_FIRE_SHIP="onFireShip",e.ON_RUN_OUT_OF_ENERGY="onRunOutOfEnergy",e.ADD_FUEL="addFuel",e.ON_CREATE_CRYSTAL="onCreateCrystal",e.ON_START_PRINT_CRYSTAL="onStartPrintCrystal",e.ON_FINISH_PRINT_CRYSTAL="onFinishPrintCrystal",e.ON_CREATE_POWER="onCreatePower",e.ON_START_PRINT_POWER="onStartPrintPower",e.ON_FINISH_PRINT_POWER="onFinishPrintPower",e.ON_SHOW_PRINT_SELECTION="onShowPrintSelection",e.ON_HIDE_PRINT_SELECTION="onHidePrintSelection",e.ON_SELECT_LEFT="onSelectLeft",e.ON_SELECT_RIGHT="onSelectRight",e.ON_PRINT_ITEM_SELECTED="onPrintItemSelected",e.ON_DOCK_CRYSTAL="onDockCrystal",e.ON_HAS_CRYSTAL="onHasCrystal",e.ON_REMOVE_CRYSTAL="onRemoveCrystal",e.ON_DOCK_POWER="onDockPower",e.ON_HAS_POWER="onHasPower",e.ON_REMOVE_POWER="onRemovePower",e.ON_UPLOAD_CRYSTAL="onUploadCrystal",e.ON_UPLOAD_POWER="onUploadPower",e.ON_UPLOAD_ITEM="onUploadItem",e.ON_FIRE_UPLOAD_CRYSTAL="onFireUploadCrystal",e.ON_FIRE_UPLOAD_POWER="onFireUploadPower",e.ON_ENABLE_UPLOAD="onEnableUpload",e.ON_DISABLE_UPLOAD="onDisableUpload",e.ON_MIX_START="onMixStart",e.ON_MIX_FINISH="onMixFinish",e.ON_CREATE_ORB="onCreateFuel",e.ON_DOCK_ORB="onDockFuel",e.ON_HAS_ORB="onHasFuel",e.ON_REMOVE_ORB="onRemoveFuel",e.ON_COLLIDE_FUEL="onCollideFuel",e.GAME_OVER="gameOver",e))(l||{}),K=(e=>(e.INITIAL="initial",e))(K||{}),f=(e=>(e.CRYSTAL="crystal",e.POWER="power",e.ORB="orb",e))(f||{});const Ne=(e,o,n)=>{t.loadSprite(e,n),t.onDraw(()=>{t.drawSprite({sprite:e,pos:o})})},Ce=e=>{e.colliders.forEach(o=>{add([rect(o.width,o.height),area(),pos(o.x,o.y),body({isStatic:!0}),color(color[0],color[1],color[2]),opacity(e.opacity),o.width>o.height?r.COLLIDER_GROUND:r.COLLIDER])})},ne={crt:()=>({u_flatness:6})};for(const e in ne)loadShaderURL(e,null,`/shaders/${e}.frag`);const ue=(e,o)=>{t.onLoad(()=>{se()}),t.onKeyPress(e,()=>{se()})},se=()=>{const e=Object.keys(ne)[0];usePostEffect(e,ne[e]())};let $=!1;const Ie=e=>{t.onUpdate(()=>{debug.inspect=$}),onKeyPress(e,()=>{$=!$})},ge=e=>{t.onKeyPress(e,()=>{setFullscreen(!isFullscreen())})},Pe={opacity:0,color:[255,255,255],colliders:[{x:224,y:256,width:256,height:16},{x:192,y:192,width:16,height:16},{x:352,y:144,width:48,height:16},{x:240,y:80,width:96,height:16},{x:16,y:256,width:144,height:16},{x:0,y:32,width:16,height:224},{x:160,y:32,width:16,height:224},{x:464,y:32,width:16,height:240},{x:176,y:32,width:16,height:176},{x:208,y:192,width:16,height:64},{x:336,y:80,width:16,height:64},{x:240,y:96,width:16,height:48},{x:400,y:144,width:16,height:64},{x:272,y:144,width:16,height:64},{x:16,y:16,width:144,height:16}]},he={sliceX:18,anims:{idle:{from:0,to:14,speed:10,loop:!0},hit:{from:15,to:17,speed:10,loop:!1}}},Te={sliceX:21,anims:{idle:{from:0,to:20,speed:10,loop:!1}}},me=3,ae=60;let _e=100,M=!1,v=0;const ye=e=>{t.loadSprite(r.ALERT,"sprites/alert.png",Te),t.loop(me,()=>{if(M)De(new Vec2(rand(e.x-ae,e.x+ae),e.y)),v++,v===5&&(v=0,M=!1,wait(10,()=>{M=!0}));else{const o=t.add([sprite(r.ALERT),pos(e),anchor("center"),body({gravityScale:.01}),z(1),opacity(1),r.ALERT]);o.play("idle"),o.onAnimEnd(n=>{n==="idle"&&(o.destroy(),M=!0)})}})},De=e=>{t.loadSprite(r.ENEMY_A,"sprites/enemy_1.png",he);const o=t.add([sprite(r.ENEMY_A),pos(e),anchor("center"),body({gravityScale:.01}),z(1),opacity(1),area(),r.ENEMY_A]);return o.onCollide(r.PROJECTILE_A,n=>{n.destroy(),o.play("hit"),_e-=50,_e<=0&&o.destroy()}),o.onCollide(r.COLLIDER_GROUND,()=>{o.trigger(l.GAME_OVER),o.destroy()}),o.onCollide(r.SHIP,()=>{o.trigger(l.GAME_OVER),o.destroy()}),o.onAnimEnd(n=>{n==="hit"&&o.play("idle")}),o};var p=(e=>(e.DOWN="down",e.PRESS="press",e))(p||{});const a={left:["left","a"],right:["right","d"],up:["up","w"],down:["down","s"],fire:["space","e"]},de=()=>[...a.left,...a.right].some(o=>t.isKeyDown(o)),pe=()=>[...a.up,...a.down].some(o=>t.isKeyDown(o)),R=(e,o=()=>{},n="down",i)=>{i.forEach(s=>{n==="press"?t.onKeyPress(s,e):t.onKeyDown(s,e),t.onKeyRelease(s,o)})},Me={sliceX:4,anims:{idle:{from:1,to:1,speed:20,loop:!1},outline:{from:0,to:0,speed:20,loop:!1},left:{from:3,to:3,speed:20,loop:!1},right:{from:2,to:2,speed:20,loop:!1}}};let w=!1;const we=e=>{t.loadSprite(r.CONTROLLER,"sprites/controller.png",Me);const o=t.add([t.sprite(r.CONTROLLER),pos(e),area(),z(0),r.CONTROLLER]);return o.play("idle"),o.onCollide(r.PLAYER,()=>{w=!0}),o.onCollideEnd(r.PLAYER,()=>{w=!1}),o.onCollide(r.PLAYER,()=>{o.play("outline")}),o.onCollideEnd(r.PLAYER,()=>{o.play("idle")}),t.on(l.ON_MOVE_SHIP_LEFT,r.PLAYER,()=>{o.play("left")}),t.on(l.ON_MOVE_SHIP_RIGHT,r.PLAYER,()=>{o.play("right")}),t.on(l.ON_MOVE_SHIP_RIGHT_UP,r.PLAYER,()=>{o.play("outline")}),t.on(l.ON_MOVE_SHIP_LEFT_UP,r.PLAYER,()=>{o.play("outline")}),R(()=>{w&&o.trigger(l.ON_ENABLE_CONTROL_SHIP)},()=>{w&&(o.play("outline"),o.trigger(l.ON_DISABLE_CONTROL_SHIP))},p.PRESS,a.fire),o},Ue={sliceX:18,anims:{idle:{from:0,to:0,speed:10,loop:!0},fuel:{from:1,to:17,speed:8,loop:!1}}},Fe={sliceX:6,anims:{idle:{from:0,to:0,speed:10,loop:!0},fuel:{from:1,to:5,speed:8,loop:!0}}},He=5,Ye=.2;let c=5,k=!1,U=!1;const Ve=e=>{t.loadSprite(r.FUEL_LINE,"sprites/fuel_line.png",Ue),t.loadSprite(r.FUEL_CELL_INDICATOR,"sprites/fuel_indicator.png",Fe),t.loadSprite(r.FUEL_CELL_A,"sprites/fuel_cell.png"),t.loadSprite(r.FUEL_CELL_B,"sprites/fuel_cell.png"),t.loadSprite(r.FUEL_CELL_C,"sprites/fuel_cell.png"),t.loadSprite(r.FUEL_CELL_D,"sprites/fuel_cell.png"),t.loadSprite(r.FUEL_CELL_E,"sprites/fuel_cell_top.png");const o=t.add([t.sprite(r.FUEL_CELL_INDICATOR),pos(e),area(),z(1),r.FUEL_CELL_INDICATOR]),n=t.add([t.sprite(r.FUEL_LINE),pos(191,197),area(),z(1),r.FUEL_LINE]);t.on(l.GAME_OVER,r.ENEMY_A,()=>{U=!1,c=5,t.go(K.INITIAL)}),o.play("idle"),n.onAnimEnd(Oe=>{Oe==="fuel"&&(c++,n.play("idle"),U=!1)});const i=t.add([t.sprite(r.FUEL_CELL_A),pos(e.x+4,e.y+30),area(),z(1),r.FUEL_CELL_A]),s=t.add([t.sprite(r.FUEL_CELL_B),pos(e.x+4,e.y+23),area(),z(1),r.FUEL_CELL_B]),_=t.add([t.sprite(r.FUEL_CELL_C),pos(e.x+4,e.y+16),area(),z(1),r.FUEL_CELL_C]),u=t.add([t.sprite(r.FUEL_CELL_D),pos(e.x+4,e.y+9),area(),z(1),r.FUEL_CELL_D]),Le=t.add([t.sprite(r.FUEL_CELL_E),pos(e.x+4,e.y+3),area(),z(1),r.FUEL_CELL_E]),Se=add([timer()]);t.on(l.ON_ENABLE_CONTROL_SHIP,r.CONTROLLER,()=>{k=!0,o.play("fuel")}),t.on(l.ON_DISABLE_CONTROL_SHIP,r.CONTROLLER,()=>{o.play("idle"),k=!1}),t.on(l.ADD_FUEL,r.FUEL_MACHINE,()=>{c<6&&n.play("fuel")}),Se.loop(He,()=>{!k||U||c>0&&c--}),o.onUpdate(()=>{i.hidden=c<1,s.hidden=c<2,_.hidden=c<3,u.hidden=c<4,Le.hidden=c<5,c===0&&!U&&(c=0,o.trigger(l.ON_RUN_OUT_OF_ENERGY))})},Ge={sliceX:4,anims:{idle:{from:0,to:0,speed:20,loop:!1},move:{from:0,to:3,speed:20,loop:!1}}},Be={sliceX:5,anims:{idle:{from:0,to:0,speed:20,loop:!0},move:{from:0,to:4,speed:20,loop:!1}}},We={sliceX:5,anims:{idle:{from:0,to:0,speed:20,loop:!1},move:{from:0,to:4,speed:20,loop:!1}}};var d=(e=>(e[e.A=0]="A",e[e.B=1]="B",e[e.C=2]="C",e))(d||{});const E=(e,o,n,i)=>{switch(o){case 0:return J(e,"sprites/grass_a.png",Ge,n,i);case 1:return J(e,"sprites/grass_b.png",Be,n,i);case 2:return J(e,"sprites/grass_c.png",We,n,i)}},J=(e,o,n,i,s)=>{t.loadSprite(s,o,n);const _=t.add([t.sprite(s),pos(e),area(),z(1),s]);return _.play("idle"),i.onCollide(s,()=>{_.play("move")}),_.onAnimEnd(u=>{u==="move"&&_.play("idle")}),_},xe={sliceX:11,anims:{idle:{from:0,to:0,speed:10,loop:!0},outline:{from:1,to:1,speed:10,loop:!0},printCrystal:{from:2,to:10,speed:10,loop:!1}}},Xe={sliceX:9,anims:{idle:{from:0,to:0,speed:1,loop:!1},progress:{from:0,to:8,speed:7,loop:!1}}},ie=(e,o)=>{t.loadSprite(r.PROGRESS,"sprites/progress_bar.png",Xe);const n=t.add([t.sprite(r.PROGRESS),pos(e),area(),z(0),r.PROGRESS]);return n.hidden=!0,n.play("idle"),n.onAnimEnd(i=>{i==="progress"&&o()}),n};let q=!1,F=!0;const ze=e=>{t.loadSprite(r.PRINT_CRYSTAL_MACHINE,"sprites/print_machine.png",xe);const o=t.add([t.sprite(r.PRINT_CRYSTAL_MACHINE),pos(e),area(),z(0),r.PRINT_CRYSTAL_MACHINE]),n=ie(new Vec2(o.pos.x,o.pos.y-10),()=>{n.hidden=!0,o.trigger(l.ON_FINISH_PRINT_CRYSTAL),o.play("idle")});return o.play("idle"),o.onCollide(r.PLAYER,()=>{q=!0,o.play("outline")}),o.onCollideEnd(r.PLAYER,()=>{q=!1,o.play("idle")}),t.on(l.ON_HAS_CRYSTAL,r.PLAYER,()=>{F=!1}),t.on(l.ON_REMOVE_CRYSTAL,r.PLAYER,()=>{F=!0}),R(()=>{q&&F&&(n.hidden=!1,n.play("progress"),o.trigger(l.ON_START_PRINT_CRYSTAL),o.play("printCrystal"),F=!1)},()=>{},p.PRESS,a.fire),o},be={sliceX:34,anims:{idle:{from:0,to:0,speed:10,loop:!0},outline:{from:1,to:1,speed:10,loop:!0},building:{from:2,to:33,speed:15,loop:!1}}};let H=!1,Y=!1;const Ke=e=>{t.loadSprite(r.FUEL_MACHINE,"sprites/fuel_machine.png",be);const o=t.add([t.sprite(r.FUEL_MACHINE),pos(e),area(),area({shape:new Rect(vec2(0,20),20,40)}),z(0),r.FUEL_MACHINE]);return o.play("idle"),o.onCollide(r.PLAYER,()=>{H||o.play("outline")}),o.onCollideEnd(r.PLAYER,()=>{H||o.play("idle")}),t.on(l.ON_COLLIDE_FUEL,r.PLAYER,(n,i)=>{const{colliding:s,hasOrb:_}=i;s&&_?Y=!0:Y=!1}),t.on(l.ADD_FUEL,r.FUEL_MACHINE,()=>{H=!0,o.play("building")}),o.onAnimEnd(n=>{n==="building"&&(H=!1,o.play("idle"))}),R(()=>{Y&&(Y=!1,o.trigger(l.ADD_FUEL))},()=>{},p.PRESS,a.fire),o},$e={sliceX:11,anims:{idle:{from:0,to:0,speed:10,loop:!0},outline:{from:1,to:1,speed:10,loop:!0},building:{from:2,to:10,speed:15,loop:!0}}},m={sliceX:30,anims:{idle:{from:1,to:29,speed:10,loop:!0},outline:{from:0,to:0,speed:10,loop:!0}}};let Q=!1,h=!1,T=!1;const ve=e=>{t.loadSprite(r.MIX_MACHINE,"sprites/mix_machine.png",$e),t.loadSprite(r.MIX_DISPLAY,"sprites/ItemDisplay.png"),t.loadSprite(r.CRYSTAL,"sprites/crystal.png",m),t.loadSprite(r.POWER,"sprites/power.png",m),t.add([t.sprite(r.MIX_DISPLAY),pos(e.x+36,e.y-10),area(),z(0),r.MIX_DISPLAY]);const o=t.add([t.sprite(r.MIX_MACHINE),pos(e),area(),z(0),r.MIX_MACHINE]),n=t.add([t.sprite(r.CRYSTAL),pos(e.x+37,e.y-9),area(),z(0),r.CRYSTAL]),i=t.add([t.sprite(r.POWER),pos(e.x+52,e.y-9),area(),z(0),r.CRYSTAL]),s=ie(new Vec2(e.x,e.y-10),()=>{s.hidden=!0,n.hidden=!0,i.hidden=!0,o.trigger(l.ON_MIX_FINISH)});return n.hidden=!0,i.hidden=!0,n.play("idle"),i.play("idle"),o.play("idle"),o.onCollide(r.PLAYER,()=>{Q=!0,o.play("outline"),o.trigger(l.ON_ENABLE_UPLOAD)}),o.onCollideEnd(r.PLAYER,()=>{Q=!1,o.play("idle"),o.trigger(l.ON_DISABLE_UPLOAD)}),t.on(l.ON_UPLOAD_CRYSTAL,r.PLAYER,()=>{h||(n.hidden=!1,h=!0)}),t.on(l.ON_UPLOAD_POWER,r.PLAYER,()=>{T||(i.hidden=!1,T=!0)}),t.on(l.ON_UPLOAD_ITEM,r.MIX_MACHINE,()=>{h&&T&&(T=!1,h=!1,s.hidden=!1,s.play("progress"),o.play("building"),o.trigger(l.ON_MIX_START))}),R(()=>{Q&&o.trigger(l.ON_UPLOAD_ITEM,{crystalLocked:h,powerLocked:T})},()=>{},p.PRESS,a.fire),o},ke={sliceX:11,anims:{idle:{from:0,to:0,speed:10,loop:!0},outline:{from:1,to:1,speed:10,loop:!0},printPower:{from:2,to:10,speed:10,loop:!1}}};let Z=!1,V=!0;const Je=e=>{t.loadSprite(r.PRINT_POWER_MACHINE,"sprites/print_machine_2.png",ke);const o=t.add([t.sprite(r.PRINT_POWER_MACHINE),pos(e),area(),z(0),r.PRINT_POWER_MACHINE]),n=ie(new Vec2(o.pos.x,o.pos.y-10),()=>{n.hidden=!0,o.trigger(l.ON_FINISH_PRINT_POWER),o.play("idle")});return o.play("idle"),o.onCollide(r.PLAYER,()=>{Z=!0,o.play("outline")}),o.onCollideEnd(r.PLAYER,()=>{Z=!1,o.play("idle")}),t.on(l.ON_HAS_POWER,r.PLAYER,()=>{V=!1}),t.on(l.ON_REMOVE_POWER,r.PLAYER,()=>{V=!0}),R(()=>{Z&&V&&(n.hidden=!1,n.play("progress"),o.trigger(l.ON_START_PRINT_POWER),o.play("printPower"),V=!1)},()=>{},p.DOWN,a.fire),o},qe={sliceX:23,anims:{run:{from:0,to:8,speed:20,loop:!0},idle:{from:9,to:12,speed:8,loop:!0},up:{from:13,to:18,speed:20,loop:!0},up_idle:{from:19,to:22,speed:8,loop:!0}}};let G=!1,j;const Qe=e=>{t.loadSprite(r.CRYSTAL,"sprites/crystal.png",m);const o=t.add([sprite(r.CRYSTAL),pos(e),z(2),area(),body(),anchor("bot"),r.CRYSTAL]);return o.play("idle"),o.onCollide(r.COLLIDER_GROUND,n=>{const i=new Vec2(o.pos.x,n.pos.y);o.destroy(),Ze(i,r.CRYSTAL)}),o},Ze=(e,o)=>{const n=t.add([sprite(o),pos(e),z(2),area(),body({isStatic:!0}),anchor("bot"),platformEffector({}),o]);n.play("idle"),t.onCollide(o,r.PLAYER,i=>{i.play("outline"),G=!0,j=i}),t.onCollideEnd(o,r.PLAYER,i=>{i.play("idle"),G=!1}),R(()=>{G&&j&&(t.destroy(j),n.trigger(l.ON_DOCK_CRYSTAL),G=!1)},()=>{},p.PRESS,a.fire)},je={sliceX:30,anims:{idle:{from:1,to:29,speed:10,loop:!0},outline:{from:0,to:0,speed:10,loop:!0}}};let B=!1,ee;const eo=e=>{t.loadSprite(r.POWER,"sprites/power.png",je);const o=t.add([sprite(r.POWER),pos(e),z(2),area(),body(),anchor("bot"),r.POWER]);return o.play("idle"),o.onCollide(r.COLLIDER_GROUND,n=>{const i=new Vec2(o.pos.x,n.pos.y);o.destroy(),oo(i,r.POWER)}),o},oo=(e,o)=>{const n=t.add([sprite(o),pos(e),z(2),area(),body({isStatic:!0}),anchor("bot"),platformEffector({}),o]);n.play("idle"),t.onCollide(o,r.PLAYER,i=>{i.play("outline"),B=!0,ee=i}),t.onCollideEnd(o,r.PLAYER,i=>{i.play("idle"),B=!1}),R(()=>{B&&ee&&(t.destroy(ee),n.trigger(l.ON_DOCK_POWER),B=!1)},()=>{},p.PRESS,a.fire)},ce={sliceX:17,anims:{idle:{from:1,to:16,speed:10,loop:!0},outline:{from:0,to:0,speed:10,loop:!0}}};let W=!1,oe;const ro=e=>{t.loadSprite(f.ORB,"sprites/fuel.png",ce);const o=t.add([sprite(f.ORB),pos(e),z(2),area(),body(),anchor("bot"),f.ORB]);return o.play("idle"),o.onCollide(r.COLLIDER_GROUND,n=>{const i=new Vec2(o.pos.x,n.pos.y);o.destroy(),to(i,f.ORB)}),o},to=(e,o)=>{const n=t.add([sprite(o),pos(e),z(2),area(),body({isStatic:!0}),anchor("bot"),platformEffector({}),o]);n.play("idle"),t.onCollide(o,r.PLAYER,i=>{i.play("outline"),W=!0,oe=i}),t.onCollideEnd(o,r.PLAYER,i=>{i.play("idle"),W=!1}),R(()=>{W&&oe&&(t.destroy(oe),n.trigger(l.ON_DOCK_ORB),W=!1)},()=>{},p.PRESS,a.fire)},b=150,S=6e3;let P=!1,g=!1,O=!0,y=!0,C=!1,N=!1,I=!1,A=!1,L=!1;function lo(e){t.loadSprite(r.PLAYER,"sprites/player.png",qe),t.loadSprite(r.CRYSTAL,"sprites/crystal.png",m),t.loadSprite(r.POWER,"sprites/power.png",m),t.loadSprite(f.ORB,"sprites/fuel.png",ce);const o=t.add([t.sprite(r.PLAYER),pos(e),anchor("bot"),area({shape:new Rect(vec2(0,0),8,16)}),body(),z(1),r.PLAYER]);return o.play("idle"),Ro(o),co(o),fo(o),Eo(),po(),_o(),ao(o),so(o),io(o),no(o),o}const no=e=>{t.on(l.ON_MIX_START,r.MIX_MACHINE,()=>{O=!1}),t.on(l.ON_MIX_FINISH,r.MIX_MACHINE,()=>{O=!0,N=!1,I=!1,L=!1}),t.on(l.ON_ENABLE_UPLOAD,r.MIX_MACHINE,()=>{L=!0}),t.on(l.ON_DISABLE_UPLOAD,r.MIX_MACHINE,()=>{L=!1}),t.on(l.ON_UPLOAD_ITEM,r.MIX_MACHINE,(o,n)=>{const{crystalLocked:i,powerLocked:s}=n;N&&!i&&(e.trigger(l.ON_UPLOAD_CRYSTAL),e.trigger(l.ON_REMOVE_CRYSTAL)),I&&!s&&(e.trigger(l.ON_UPLOAD_POWER),e.trigger(l.ON_REMOVE_POWER))})},io=e=>{const o=t.add([t.sprite(f.ORB),pos(e.pos.x,e.pos.y-16),anchor("bot"),area(),z(1),f.ORB]);o.parent=e,o.hidden=!0,e.onUpdate(()=>{o.pos=e.pos.sub(0,16)}),t.on(l.ON_DOCK_ORB,f.ORB,()=>{e.trigger(l.ON_HAS_ORB),A=!0,o.hidden=!1}),t.on(l.ON_MIX_FINISH,r.MIX_MACHINE,()=>{A=!0,o.hidden=!1,e.trigger(l.ON_HAS_ORB)}),t.on(l.ADD_FUEL,r.FUEL_MACHINE,()=>{A=!1,o.hidden=!0}),e.onCollide(r.FUEL_MACHINE,()=>{A&&(L=!0),e.trigger(l.ON_COLLIDE_FUEL,{colliding:!0,hasOrb:A})}),e.onCollideEnd(r.FUEL_MACHINE,()=>{L=!1,e.trigger(l.ON_COLLIDE_FUEL,{colliding:!1,hasOrb:A})}),R(()=>{A&&!L&&(L=!1,e.trigger(l.ON_REMOVE_ORB),A=!1,o.hidden=!0,ro(o.pos).addForce(vec2(y?S:-S,-S)))},()=>{},p.PRESS,a.fire)},so=e=>{const o=t.add([t.sprite(r.POWER),pos(e.pos.x,e.pos.y-16),anchor("bot"),area(),z(1),r.POWER]);o.parent=e,o.hidden=!0,e.onUpdate(()=>{o.pos=e.pos.sub(0,16)}),o.play("idle"),t.on(l.ON_DOCK_POWER,f.POWER,()=>{e.trigger(l.ON_HAS_POWER),I=!0,o.hidden=!1}),t.on(l.ON_FINISH_PRINT_POWER,r.PRINT_POWER_MACHINE,()=>{I=!0,o.hidden=!1}),t.on(l.ON_UPLOAD_POWER,r.PLAYER,()=>{I=!1,o.hidden=!0}),R(()=>{I&&!L&&(e.trigger(l.ON_REMOVE_POWER),I=!1,o.hidden=!0,eo(o.pos).addForce(vec2(y?S:-S,-S)))},()=>{},p.PRESS,a.fire)},ao=e=>{const o=t.add([t.sprite(r.CRYSTAL),pos(e.pos.x,e.pos.y-16),anchor("bot"),area(),z(1),r.CRYSTAL]);o.parent=e,o.hidden=!0,e.onUpdate(()=>{o.pos=e.pos.sub(0,16)}),o.play("idle"),t.on(l.ON_DOCK_CRYSTAL,f.CRYSTAL,()=>{e.trigger(l.ON_HAS_CRYSTAL),N=!0,o.hidden=!1}),t.on(l.ON_FINISH_PRINT_CRYSTAL,r.PRINT_CRYSTAL_MACHINE,()=>{N=!0,o.hidden=!1}),t.on(l.ON_UPLOAD_CRYSTAL,r.PLAYER,()=>{N=!1,o.hidden=!0}),R(()=>{N&&!L&&(e.trigger(l.ON_REMOVE_CRYSTAL),N=!1,o.hidden=!0,Qe(o.pos).addForce(vec2(y?S:-S,-S)))},()=>{},p.PRESS,a.fire)},_o=()=>{t.on(l.ON_START_PRINT_POWER,r.PRINT_POWER_MACHINE,()=>{O=!1}),t.on(l.ON_FINISH_PRINT_POWER,r.PRINT_POWER_MACHINE,()=>{O=!0})},po=()=>{t.on(l.ON_START_PRINT_CRYSTAL,r.PRINT_CRYSTAL_MACHINE,()=>{O=!1}),t.on(l.ON_FINISH_PRINT_CRYSTAL,r.PRINT_CRYSTAL_MACHINE,()=>{O=!0})},Eo=()=>{t.on(l.ON_ENABLE_CONTROL_SHIP,r.CONTROLLER,()=>{N||(C=!0)}),t.on(l.ON_DISABLE_CONTROL_SHIP,r.CONTROLLER,()=>{C=!1})},Ro=e=>{R(()=>{g&&e.play("up")},()=>{!pe()&&g&&e.play("up_idle")},p.PRESS,[...a.up,...a.down]),R(()=>{e.isGrounded()&&!g&&!C&&O&&e.play("run")},()=>{!de()&&!g&&e.play("idle")},p.PRESS,[...a.left,...a.right]),e.onCollideEnd(r.STAIR,()=>{de()?e.play("run"):e.play("idle")}),e.onCollide(r.STAIR,()=>{pe()?e.play("up"):e.play("up_idle")}),e.onCollide(r.CONTROLLER,()=>{C&&e.play("idle")})},co=e=>{e.onCollide(r.STAIR,()=>{g=!0,e.gravityScale=0}),e.onCollideEnd(r.STAIR,()=>{g=!1,e.gravityScale=1}),R(()=>{g&&e.move(0,-b)},()=>{},p.DOWN,a.up),R(()=>{e.move(0,b)},()=>{},p.DOWN,a.down)},fo=e=>{R(()=>{C?(e.trigger(l.ON_MOVE_SHIP_LEFT),P||(e.play("idle"),P=!0)):O&&(e.move(-b,0),e.flipX=!0,y=!1)},()=>{C&&e.trigger(l.ON_MOVE_SHIP_LEFT_UP),P=!1},p.DOWN,a.left),R(()=>{C?(e.trigger(l.ON_MOVE_SHIP_RIGHT),P||(e.play("idle"),P=!0)):O&&(e.move(b,0),y=!0,e.flipX=!1)},()=>{C&&e.trigger(l.ON_MOVE_SHIP_RIGHT_UP),P=!1},p.DOWN,a.right)};var D=(e=>(e.A="projectile_a",e.B="projectile_b",e))(D||{});const Ee=(e,o,n)=>{switch(n){case D.A:t.loadSprite(n,"sprites/projectile_a.png");break;case D.B:t.loadSprite(n,"sprites/projectile_b.png");break}const i=t.add([t.sprite(n),pos(o.x,o.y),area(),body(),move(UP,e),z(1),n]);return i.gravityScale=0,i.onCollide(r.COLLIDER_GROUND,()=>{i.destroy()}),i};var fe=(e=>(e.A="fire_a",e.B="fire_b",e))(fe||{});const Lo={sliceX:12,anims:{idle:{from:0,to:2,speed:10,loop:!0},fire_a:{from:3,to:8,speed:15,loop:!0},fire_b:{from:9,to:11,speed:15,loop:!0}}},x=150,So=fe.A;let re=!1,te=!1,X=!0;const Oo=e=>{t.loadSprite(r.SHIP,"sprites/spaceship.png",Lo);const o=t.add([t.sprite(r.SHIP),pos(e),area(),body(),z(1),r.SHIP]);return o.play("idle"),o.gravityScale=0,add([timer()]).loop(Ye,()=>{re&&X&&(te=!te,te?Ee(x,vec2(o.pos.x+7,o.pos.y-6),D.A):Ee(x,vec2(o.pos.x+25,o.pos.y-6),D.A))}),t.on(l.ON_RUN_OUT_OF_ENERGY,r.FUEL_CELL_INDICATOR,()=>{X=!1,o.play("idle")}),t.on(l.ADD_FUEL,r.FUEL_MACHINE,()=>{X=!0}),t.on(l.ON_ENABLE_CONTROL_SHIP,r.CONTROLLER,()=>{X&&(re=!0,o.play(So))}),t.on(l.ON_DISABLE_CONTROL_SHIP,r.CONTROLLER,()=>{re=!1,o.play("idle")}),t.on(l.ON_MOVE_SHIP_LEFT,r.PLAYER,()=>{o.move(-x,0)}),t.on(l.ON_MOVE_SHIP_RIGHT,r.PLAYER,()=>{o.move(x,0)}),o},le=(e,o)=>(t.loadSprite(r.STAIR,o),t.add([t.sprite(r.STAIR),pos(e),area(),z(0),r.STAIR])),Ao={sliceX:7,anims:{idle:{from:0,to:0,speed:10,loop:!0}}},Re=60,No=e=>{t.loadSprite(r.STARS,"sprites/stars.png",Ao),loop(.1,()=>{const o=add([pos(new Vec2(rand(e.x-Re,e.x+Re),e.y)),sprite(r.STARS),anchor("center"),body({gravityScale:.04}),lifespan(1.5),opacity(1),r.STARS]);o.frame=Co(6)})},Co=e=>Number(rand(0,e).toFixed(0)),uo=1e3;t.scene(K.INITIAL,()=>{ge("f"),Ie("r"),ue("g"),Ne("world",vec2(0,0),"sprites/world.png"),setGravity(uo),Ce(Pe);const e=lo(new Vec2(205,173));le(new Vec2(417,136),"sprites/stair_a.png"),le(new Vec2(225,184),"sprites/stair_b.png"),le(new Vec2(353,72),"sprites/stair_c.png"),Oo(new Vec2(72,240)),we(new Vec2(326,232)),E(new Vec2(240,248),d.A,e,r.GRASS_A),E(new Vec2(258,248),d.B,e,r.GRASS_B),E(new Vec2(354,248),d.A,e,r.GRASS_C),E(new Vec2(363,248),d.B,e,r.GRASS_D),E(new Vec2(374,248),d.A,e,r.GRASS_E),E(new Vec2(409,248),d.A,e,r.GRASS_F),E(new Vec2(415,248),d.B,e,r.GRASS_G),E(new Vec2(423,248),d.B,e,r.GRASS_H),E(new Vec2(192,184),d.A,e,r.GRASS_I),E(new Vec2(200,184),d.B,e,r.GRASS_J),E(new Vec2(210,184),d.B,e,r.GRASS_K),E(new Vec2(307,64),d.C,e,r.GRASS_L),E(new Vec2(302,240),d.C,e,r.GRASS_M),E(new Vec2(325,72),d.A,e,r.GRASS_N),E(new Vec2(333,72),d.B,e,r.GRASS_O),E(new Vec2(343,72),d.A,e,r.GRASS_P),E(new Vec2(406,136),d.B,e,r.GRASS_Q),Ke(new Vec2(192,127)),ve(new Vec2(250,47)),ze(new Vec2(375,109)),Je(new Vec2(433,219)),Ve(new Vec2(177,210)),No(new Vec2(90,36)),ye(new Vec2(90,56))});t.go(K.INITIAL);
//# sourceMappingURL=index-BKJIknUo.js.map
